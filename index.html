<!-- Indicators LTO Checkout â¢ Self-Contained Embed (Combo Plans) -->
<section id="indicators-checkout">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

    #indicators-checkout {
      font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      color: #1a1a1a;
      line-height: 1.5;
      box-sizing: border-box;
    }

    #indicators-checkout *, #indicators-checkout *::before, #indicators-checkout *::after {
      box-sizing: border-box;
    }

    #indicators-checkout .wrap {
      max-width: 720px;
      margin: 0 auto;
      padding: 16px;
    }

    #indicators-checkout .checkout-card {
      background: #ffffff;
      border: 1px solid #e0e0e0;
      border-radius: 16px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      padding: 32px;
    }

    #indicators-checkout .separator {
      height: 1px;
      background: linear-gradient(90deg, transparent, #e0e0e0, transparent);
      margin: 8px 0 4px 0;
    }

    /* Custom Checkout Button */
    #indicators-checkout .custom-checkout-btn {
      width: 100%;
      padding: 23px 24px;
      background: linear-gradient(180deg, #3678e6 0%, #2159de 100%);
      color: white;
      font-size: 22px;
      font-weight: 600;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.15s ease;
      font-family: inherit;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 0 #2159de, 0 6px 12px rgba(33,89,222,0.35), inset 0 1px 0 rgba(255,255,255,0.15), inset 0 0 0 1px rgba(0,0,0,0.08), inset 0 -1px 3px rgba(0,0,0,0.1);
      margin-top: 0;
      animation: subtleBounce 3s ease-in-out infinite;
    }

    @keyframes subtleBounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-2px);
      }
    }

    #indicators-checkout .custom-checkout-btn:hover {
      background: linear-gradient(180deg, #4080e8 0%, #2a65e5 100%);
    }

    #indicators-checkout .custom-checkout-btn:active {
      transform: translateY(2px);
      box-shadow: 0 2px 0 #2159de, 0 3px 6px rgba(33,89,222,0.35), inset 0 1px 0 rgba(255,255,255,0.15), inset 0 0 0 1px rgba(0,0,0,0.08), inset 0 -1px 3px rgba(0,0,0,0.1);
    }

    /* Addons Section */
    #indicators-checkout .addons-section {
      margin-bottom: 4px;
    }

    #indicators-checkout .addons-label {
      font-size: 12px;
      font-weight: 600;
      color: #666666;
      margin: 0 0 12px 0;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Addon Cards */
    #indicators-checkout .addon-card {
      display: grid;
      grid-template-columns: 64px 1fr 48px;
      align-items: flex-start;
      gap: 26px;
      padding: 16px;
      background: rgba(255, 249, 220, 0.92);
      border: 2.1px dashed #888888;
      border-radius: 12px;
      margin-bottom: 12px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    #indicators-checkout .addon-card::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: -100%;
      width: 200%;
      height: 60%;
      background: linear-gradient(
        90deg,
        transparent 0%,
        transparent 40%,
        rgba(255, 255, 255, 0.4) 50%,
        transparent 60%,
        transparent 100%
      );
      animation: shimmer 6s ease-in-out infinite;
      pointer-events: none;
      z-index: 0;
    }

    @keyframes shimmer {
      0%, 100% {
        left: -100%;
      }
      50% {
        left: 100%;
      }
    }

    #indicators-checkout .addon-card:hover {
      background: rgba(255, 247, 212, 0.92);
      border-color: #666666;
    }

    #indicators-checkout .addon-card.selected {
      border-color: #22c55e;
      border-style: solid;
      background: #f0fdf4;
    }

    #indicators-checkout .addon-card.selected::before {
      display: none;
    }

    /* Addon Icon */
    #indicators-checkout .addon-icon {
      width: 64px;
      height: 64px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #f5f5f5 0%, #efefef 100%);
      border-radius: 10px;
      flex-shrink: 0;
      grid-column: 1;
      grid-row: 1;
      overflow: hidden;
    }

    /* Addon Content */
    #indicators-checkout .addon-content {
      grid-column: 2;
      grid-row: 1;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 3px;
      padding-top: 12px;
    }

    #indicators-checkout .addon-title {
      font-size: 17px;
      font-weight: 600;
      color: #1a1a1a;
      margin: 0;
      line-height: 1.3;
      text-align: left;
    }

    #indicators-checkout .addon-pricing {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 8px;
      margin-top: 2px;
    }

    #indicators-checkout .addon-price-current {
      font-size: 16px;
      font-weight: 700;
      color: #0052cc;
    }

    #indicators-checkout .addon-price-original {
      font-size: 13px;
      font-weight: 500;
      color: #9ca3af;
      text-decoration: line-through;
    }

    /* Expanded Content (always visible) */
    #indicators-checkout .addon-expanded-content {
      display: block;
      grid-column: 1 / -1;
      margin-top: 0;
      padding: 18px 16px;
      border-top: 1px solid #e0e0e0;
      position: relative;
      background: #ffffff;
      margin-left: -16px;
      margin-right: -16px;
      margin-bottom: -16px;
      border-radius: 0 0 10px 10px;
      z-index: 1;
    }

    /* Specific positioning adjustments for addon expanded content */
    #indicators-checkout .addon-card:nth-of-type(1) .addon-expanded-content {
      margin-top: -18px;
    }

    #indicators-checkout .addon-card:nth-of-type(2) .addon-expanded-content {
      margin-top: -13.5px;
    }

    #indicators-checkout .addon-expanded-text {
      font-size: 12px;
      color: #000000;
      line-height: 1.5;
      margin-top: 0;
    }

    #indicators-checkout .addon-offer-label {
      font-weight: 700;
      color: #ef4444;
      text-decoration: underline;
      display: inline;
    }

    /* Addon Checkbox Button */
    #indicators-checkout .addon-checkbox {
      width: 26px;
      height: 26px;
      border-radius: 4px;
      background: white;
      border: 2px solid #d0d0d0;
      color: white;
      cursor: pointer;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      grid-column: 3;
      grid-row: 1;
      margin-left: -10px;
      margin-top: 16px;
      padding: 0;
      position: relative;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      font-size: 14px;
      font-weight: bold;
      line-height: 1;
    }

    #indicators-checkout .addon-checkbox::before {
      content: '';
      position: absolute;
      left: -32px;
      width: 20px;
      height: 20px;
      background: #ef4444;
      clip-path: polygon(0 20%, 50% 20%, 50% 0%, 100% 50%, 50% 100%, 50% 80%, 0 80%);
      top: 50%;
      transform: translateY(-50%);
      z-index: 2;
      animation: arrowBounce 1.5s ease-in-out infinite;
    }

    @keyframes arrowBounce {
      0%, 100% {
        transform: translateY(-50%) translateX(0);
      }
      50% {
        transform: translateY(-50%) translateX(6px);
      }
    }

    #indicators-checkout .addon-checkbox:hover {
      border-color: #b0b0b0;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    #indicators-checkout .addon-checkbox.checked {
      background: #22c55e;
      border-color: #22c55e;
      color: white;
    }

    #indicators-checkout .addon-checkbox.checked::before {
      display: none;
    }

    #indicators-checkout .addon-checkbox.checked::after {
      content: '';
      display: block;
      position: absolute;
      width: 7px;
      height: 13px;
      border-right: 2.5px solid white;
      border-bottom: 2.5px solid white;
      border-radius: 1px;
      transform: rotate(45deg);
      top: 3px;
      left: 8px;
    }

    /* Main Checkout Container */
    #indicators-checkout .checkout-container {
      min-height: 500px;
      padding: 0;
    }

    /* Whop Checkout Mount Styling */
    #indicators-checkout #whop-checkout-mount {
      min-height: 300px;
      overflow: visible !important;
      margin-bottom: 16px;
    }

    #indicators-checkout #whop-checkout-mount iframe {
      width: 100%;
      min-height: 300px;
      height: auto;
      border: none;
      overflow: visible !important;
      display: block;
    }

    #indicators-checkout .loading-text {
      text-align: center;
      font-size: 12px;
      color: #666666;
      font-style: italic;
      margin: 12px 0;
    }

    /* Guarantee Section */
    #indicators-checkout .guarantee-section {
      display: flex;
      align-items: center;
      gap: 20px;
      background: linear-gradient(135deg, #fef9e7 0%, #fcefc7 100%);
      border: 1px solid #f4d58d;
      border-radius: 12px;
      padding: 12px 24px;
      margin-top: 24px;
      box-shadow: 0 2px 8px rgba(244, 180, 26, 0.1);
      position: relative;
      top: -12px;
    }

    #indicators-checkout .guarantee-badge {
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #indicators-checkout .guarantee-text {
      flex: 1;
    }

    #indicators-checkout .guarantee-text p {
      margin: 0;
      font-size: 13px;
      line-height: 18px;
      color: #1a1a1a;
      font-family: inherit;
      font-weight: 500;
      letter-spacing: -0.01em;
    }

    #indicators-checkout .guarantee-text strong {
      font-weight: 600;
      color: #000000;
    }

    /* Responsive */
    @media (max-width: 768px) {
      #indicators-checkout .checkout-card {
        padding: 20px;
      }

      #indicators-checkout .addon-card {
        grid-template-columns: 50px 1fr 40px;
        gap: 12px;
        padding: 12px;
      }

      #indicators-checkout .addon-icon {
        width: 50px;
        height: 50px;
      }

      #indicators-checkout .addon-icon svg {
        width: 40px;
        height: 40px;
      }

      #indicators-checkout .addon-title {
        font-size: 13px;
      }

      #indicators-checkout .addon-checkbox {
        margin-left: -5px;
        margin-top: 10px;
      }

      #indicators-checkout .addon-checkbox::before {
        left: -28px;
        width: 16px;
        height: 16px;
      }

      #indicators-checkout #whop-checkout-mount {
        width: 100%;
        overflow: visible !important;
      }

      #indicators-checkout #whop-checkout-mount iframe {
        width: 100% !important;
        max-width: 100% !important;
        min-height: 300px;
        height: auto !important;
        display: block !important;
        overflow: visible !important;
      }

      #indicators-checkout .checkout-container {
        width: 100%;
        overflow: visible;
      }

      #indicators-checkout .guarantee-section {
        flex-direction: column;
        text-align: center;
        gap: 12px;
        padding: 16px 20px;
      }

      #indicators-checkout .guarantee-badge svg {
        width: 60px;
        height: 60px;
      }

      #indicators-checkout .guarantee-text p {
        font-size: 13px;
      }
    }
  </style>

  <div class="wrap">
    <div class="checkout-card">
      
      <!-- Add-ons Section (Top) -->
      <div class="addons-section">

        <!-- Risk Calculator Addon -->
        <div class="addon-card" data-addon="riskCalc">
          <div class="addon-icon">
            <img src="https://fonts.gstatic.com/s/i/productlogos/chrome_store/v7/192px.svg" alt="Risk Calculator" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <div class="addon-content">
            <h4 class="addon-title">TJR's Risk Management Calculator</h4>
            <div class="addon-pricing">
              <span class="addon-price-current">$77</span>
              <span class="addon-price-original">$249</span>
            </div>
          </div>
          <button class="addon-checkbox" data-addon-checkbox="riskCalc" type="button"></button>
          <div class="addon-expanded-content">
            <div class="addon-expanded-text">
              <span class="addon-offer-label">ONE-TIME OFFER:</span> Get instant access to the powerful calculator TJR uses to lock in the exact risk you should take on every trade. You'll know how much to risk, how many contracts to trade, and when to walk away - based on math, not emotion. Only available on this page for just $77.
            </div>
          </div>
        </div>

        <!-- Trading Journal Addon -->
        <div class="addon-card" data-addon="tradingJournal">
          <div class="addon-icon">
            <img src="https://fonts.gstatic.com/s/i/productlogos/chrome_store/v7/192px.svg" alt="Trading Journal" style="width: 100%; height: 100%; object-fit: contain;">
          </div>
          <div class="addon-content">
            <h4 class="addon-title">TJR's Trading Journal 2.0</h4>
            <div class="addon-pricing">
              <span class="addon-price-current">$57</span>
              <span class="addon-price-original">$199</span>
            </div>
          </div>
          <button class="addon-checkbox" data-addon-checkbox="tradingJournal" type="button"></button>
          <div class="addon-expanded-content">
            <div class="addon-expanded-text">
              <span class="addon-offer-label">ONE-TIME OFFER:</span> Get instant access to the exact journal TJR uses to track setups, wins/losses, and emotional mistakes - so you can spot patterns, fix leaks, and level up faster. Only available on this page for just $57.
            </div>
          </div>
        </div>
      </div>

      <!-- Main Product Checkout (Bottom) -->
      <div class="checkout-container">
        <div class="loading-text" id="main-loading">Loading secure checkout</div>
        <div id="whop-checkout-mount">
          <!-- Initial embed - Whop script will find this on load -->
          <div
            data-whop-checkout-plan-id="plan_H3aw3n7IvJDzN"
            data-whop-checkout-theme="light"
            data-whop-checkout-theme-accent-color="blue"
            data-whop-checkout-return-url="https://google.com"
            data-whop-checkout-hide-price="true"
            data-whop-checkout-hide-tos="true"
            data-whop-checkout-hide-email="true"
            data-whop-checkout-hide-address="true"
            data-whop-checkout-prefill-email="adrianpaleka@gmail.com"
          ></div>
        </div>

        <p style="text-align: center; font-size: 11px; color: #666666; margin: 16px 0 0 0; line-height: 1.5; white-space: nowrap; font-weight: 500; display: flex; align-items: center; justify-content: center; gap: 4px;">
          <svg width="12" height="13" viewBox="0 0 20 22" fill="none" xmlns="http://www.w3.org/2000/svg" style="flex-shrink: 0;">
            <path d="M10 0.5L1 4V10C1 15.5 4.5 20.5 10 21.5C15.5 20.5 19 15.5 19 10V4L10 0.5Z" fill="#16a34a"/>
            <path d="M6 10.5L8.5 13L14 7.5" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span style="font-size: 11.5px;">We do not store any of your card information. Payments are securely encrypted & processed by Stripe.</span>
        </p>
        <div class="checkout-badges">
          <img src="https://i.imgur.com/jWBwCk9.png" alt="Payment badges" style="display: block; margin: 4px auto 0; max-width: 95%; height: auto;">
        </div>

        <!-- Money Back Guarantee Section -->
        <div class="guarantee-section">
          <div class="guarantee-badge">
            <img src="https://i.imgur.com/iEgt84X.png" alt="Money Back Guarantee" style="width: 90px; height: 90px; object-fit: contain;">
          </div>
          <div class="guarantee-text">
            <p><strong>RISK FREE 100% GUARANTEE:</strong> if you try it out and don't see immediate value, we'll give you a 100% refund - no questions asked.</p>
          </div>
        </div>
      </div>

    </div>
  </div>

  <script>
    // ===== Plan Configuration (Combo Plans) =====
    const PLAN_MAP = {
      // [riskCalc, tradingJournal] â planId
      'false,false': 'plan_H3aw3n7IvJDzN',      // Main only
      'true,false':  'plan_yOnczbRi8luJR',      // Main + Risk Calculator
      'false,true':  'plan_0RuJva4sozlDt',      // Main + Trading Journal
      'true,true':   'plan_BGTaQDcKjWjCb'       // Main + Both
    };

    // ===== State =====
    const state = {
      addons: {
        riskCalc: false,
        tradingJournal: false
      }
    };

    // ===== DOM Helpers =====
    const qs = (sel) => document.querySelector(sel);
    const qsa = (sel) => Array.from(document.querySelectorAll(sel));

    // ===== Get Current Plan ID Based on Selection =====
    function getCurrentPlanId() {
      const key = `${state.addons.riskCalc},${state.addons.tradingJournal}`;
      return PLAN_MAP[key] || PLAN_MAP['false,false'];
    }

    // ===== Mount/Update Whop Checkout =====
    function mountWhopCheckout() {
      const container = qs('#whop-checkout-mount');
      if (!container) return;

      const planId = getCurrentPlanId();
      
      // Clear and recreate - Whop auto-detects new embeds
      container.innerHTML = '';
      
      const embedDiv = document.createElement('div');
      embedDiv.setAttribute('data-whop-checkout-plan-id', planId);
      embedDiv.setAttribute('data-whop-checkout-theme', 'light');
      embedDiv.setAttribute('data-whop-checkout-theme-accent-color', 'blue');
      embedDiv.setAttribute('data-whop-checkout-return-url', 'https://google.com');
      embedDiv.setAttribute('data-whop-checkout-hide-price', 'true');
      embedDiv.setAttribute('data-whop-checkout-hide-tos', 'true');
      embedDiv.setAttribute('data-whop-checkout-hide-email', 'true');
      embedDiv.setAttribute('data-whop-checkout-hide-address', 'true');
      embedDiv.setAttribute('data-whop-checkout-prefill-email', 'adrianpaleka@gmail.com');
      
      container.appendChild(embedDiv);

      // Hide loading indicator once iframe appears
      hideLoadingWhenReady();
    }

    // ===== Hide Loading When Ready =====
    function hideLoadingWhenReady() {
      const loadingEl = qs('#main-loading');
      const container = qs('#whop-checkout-mount');
      if (!loadingEl || !container) return;

      let tries = 0;
      (function waitForIframe() {
        const hasIframe = container.querySelector('iframe');
        if (hasIframe) {
          loadingEl.style.display = 'none';
          return;
        }
        if (tries++ < 50) {
          setTimeout(waitForIframe, 200);
        }
      })();
    }

    // ===== Toggle Addon Selection =====
    function toggleAddon(addonKey) {
      state.addons[addonKey] = !state.addons[addonKey];

      // Update UI for all matching cards (top and bottom sections)
      qsa(`[data-addon="${addonKey}"]`).forEach(card => {
        card.classList.toggle('selected', state.addons[addonKey]);
      });
      qsa(`[data-addon-checkbox="${addonKey}"]`).forEach(checkbox => {
        checkbox.classList.toggle('checked', state.addons[addonKey]);
      });
      
      // Show loading again while checkout updates
      const loadingEl = qs('#main-loading');
      if (loadingEl) loadingEl.style.display = 'block';
      
      // Update Whop checkout with new plan
      mountWhopCheckout();
    }

    // ===== Event Binding =====
    function bindEvents() {
      // Addon checkbox buttons
      qsa('[data-addon-checkbox]').forEach(btn => {
        btn.addEventListener('click', () => {
          toggleAddon(btn.dataset.addonCheckbox);
        });
      });
    }

    // ===== Initialization =====
    function init() {
      bindEvents();

      // Hide loading when iframe appears
      hideLoadingWhenReady();
    }

    // ===== Run =====
    if (document.readyState !== 'loading') {
      init();
    } else {
      document.addEventListener('DOMContentLoaded', init);
    }
  </script>

  <!-- Whop Checkout Loader -->
  <script async defer src="https://js.whop.com/static/checkout/loader.js"></script>
</section>